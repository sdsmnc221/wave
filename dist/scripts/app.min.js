$(document).ready(function(){var t=["Chlore","OxyConcentration","Oxygene","pH","Pression","Salinite","TempeAir","TempeEau"],n={EN:["Chlorine","Saturation","Oxygene","pH","Pressure","Salinity","Air Temp.","Water Temp."],FR:["Chlore","Saturation","Oxygène","pH","Pression","Salinité","Temp. d'Air","Temp. d'Eau"],VI:["Clo","Độ bão hoà","Ôxy","pH","Áp suất","Nồng độ muối","Nhiệt độ không khí","Nhiệt độ nước"]},e="../scripts/api.php",a=n[$("html").attr("lang").trim().toUpperCase()];Barba.Pjax.init(),Barba.Prefetch.init(),Barba.Pjax.originalPreventCheck=Barba.Pjax.preventCheck,Barba.Pjax.preventCheck=function(t,n){return!!Barba.Pjax.originalPreventCheck(t,n)&&!(/vi/.test(n.href.toLowerCase())||/fr/.test(n.href.toLowerCase())||/en/.test(n.href.toLowerCase()))};var i=Barba.BaseTransition.extend({start:function(){Promise.all([this.newContainerLoading,this.fadeOut()]).then(this.fadeIn.bind(this))},fadeOut:function(){return $(this.oldContainer).animate({opacity:0}).promise()},fadeIn:function(){var t=this;url=window.location.href.slice(23),document.body.scrollTop=0,$(".nav-link-active").removeClass("nav-link-active"),$(".nav-link[href='"+url+"']").addClass("nav-link-active"),$(this.oldContainer).hide(),$(this.newContainer).css({visibility:"visible",opacity:0}),$(this.newContainer).animate({opacity:1},"slow",function(){t.done()})}}),r=function(){var t=window.location.href;return t.indexOf("en")?"en":t.indexOf("fr")?"fr":"vi"};function o(){$(".app .controller__refresh").on("click",function(t){s()}),$(".card__infobox").each(function(t,n){var e=$(n).find("h3").text().trim();-1===e.indexOf("Temp")&&-1===e.indexOf("Nhiệt độ")||$(n).attr("title","Conversion Celsius <-> Farenheit").css("cursor","pointer").on("click",function(t){var n=$(t.currentTarget).find("p"),e=parseFloat(n.text().trim());-1!==n.text().indexOf("°C")?n.html((1.8*e+32).toFixed(2)+'<span class="unit">°F</span'):n.html(((e-32)/1.8).toFixed(2)+'<span class="unit">°C</span')})})}function s(){if(-1!==window.location.href.indexOf("details.html")){var n=$(".controller__stats .dropdown-toggle").text().trim();$.ajax({url:e,dataType:"json",data:{read_all:t[a.findIndex(function(t){return t===n})]}}).done(function(t){var e=t[0].Valeurs.toFixed(2),a=r();graphName="en"===a?"<h2>"+n+"'s Graph</h2>":"fr"===a?"<h2>Graphe : "+n+"</h2>":"<h2>Biểu đồ "+n+"</h2>",$(".card--current .card__infobox p").html(-1!==n.indexOf("Temp")||-1!==n.indexOf("Nhiệt độ")?e+'<span class="unit">°C</span':-1!==n.indexOf("Press")||-1!==n.indexOf("Áp suất")?e+'<span class="unit">pHa</span':e),$(".card--current .card__infobox h3").text(n.toUpperCase()),$($(".card__graph").siblings()[0]).html(graphName),l(),d(t)})}else $.ajax({url:e,dataType:"json",data:{read_lo:!0}}).done(function(n){$(".card__infobox").each(function(e,i){var r=$(i).find("h3").text().trim(),o=n.find(function(n){return n.type===t[a.findIndex(function(t){return t===r})]}).Valeurs.toFixed(2);$(i).find("p").html(-1!==r.indexOf("Temp")?o+'<span class="unit">°C</span':-1!==r.indexOf("Press")?o+'<span class="unit">pHa</span':o),l(),d(n.slice(0,7))})});setTimeout(function(){s()},1e4)}function l(){var t=$(".controller__stats .dropdown-toggle").text().trim();$("");c(t)}function c(n){var i=r();$.ajax({url:e,dataType:"json",data:{read_all:t[a.findIndex(function(t){return t===n})]}}).done(function(t){var e=-1===window.location.href.indexOf("details.html")?f(t,7):f(t,t.length),a=$("#graph"),r={type:"line",labels:e.map(function(t){return t.x}),data:{datasets:[{data:e,label:n,borderColor:"#03A9F4",fill:!1}]},options:{title:{display:!0,text:"en"===i?"Last 7 "+n+" stats":"fr"===i?n+" - Les 7 dernières valeurs":"7 giá trị cuối cùng của "+n},scales:{xAxes:[{type:"time",time:{parser:"MM/DD/YYYY HH:mm",unit:"day",tooltipFormat:"ll HH:mm"},scaleLabel:{display:!1,labelString:"Date"}}],yAxes:[{scaleLabel:{display:!1,labelString:"Value"},ticks:{stepSize:10,min:0,max:100}}]}}};return new Chart(a,r)})}function d(t){var n="";t.forEach(function(t,e){n+='<tr>\n                <th scope="row"> '+(-1!==window.location.href.indexOf("detail.html")?t.ID:e+1)+" </th>\n                <td> "+t.Valeurs+" </td>\n                <td> "+p(t.time)+" </td>\n            </tr>"}),$("#table tbody").html(n),$("#table").parent().scrollTop(0)}function f(t,n){return t.slice(0,n).map(function(t){return{x:p(t.time),y:t.Valeurs}})}function p(t){return moment(t,"YYYY/MM/DD HH:mm").toDate()}Barba.Pjax.getTransition=function(){return i},Barba.Dispatcher.on("initStateChange",function(){var t=window.location.href;a=t.indexOf("en")?n.EN:t.indexOf("fr")?n.FR:n.VI}),Barba.Dispatcher.on("transitionCompleted",function(){r(),o(),l(),-1===window.location.href.indexOf("contact.html")&&-1===window.location.href.indexOf("about.html")&&s()}),$(".app").on("click",".menu .controller__sidebar",function(){$(".menu").css("transform","translateX(-110%)").removeClass("col-12 col-md-3 col-lg-2"),$("#barba-wrapper").removeClass("col-md-9 col-lg-10"),$(".header nav").css("margin-left","65px"),$(".header .controller__sidebar").removeClass("invisible")}),$(".app").on("click",".header .controller__sidebar",function(){$(".menu").addClass("col-12 col-md-3 col-lg-2").css("transform","translateX(0%)"),$("#barba-wrapper").addClass("col-md-9 col-lg-10"),$(".header nav").css("margin-left","0"),$(".header .controller__sidebar").addClass("invisible")}),$(".dropdown-toggle").dropdown(),o(),-1===window.location.href.indexOf("contact.html")&&-1===window.location.href.indexOf("about.html")&&s(),$(".app").on("click",".controller__stats button.dropdown-item",function(){var t=$(this).text().trim();$(".controller__stats .dropdown-toggle").text(t),$(".controller__stats .dropdown-menu .dropdown-item").each(function(n,e){$(e).removeClass("active"),$(e).text()===t&&$(e).addClass("active")}),-1!==t.indexOf("Temp")||-1!==t.indexOf("Nhiệt độ")?$(".card__infobox").attr("title","Conversion Celsius <-> Farenheit").css("cursor","pointer").on("click",function(t){var n=$(t.currentTarget).find("p"),e=parseFloat(n.text().trim());-1!==n.text().indexOf("°C")?n.html((1.8*e+32).toFixed(2)+'<span class="unit">°F</span'):n.html(((e-32)/1.8).toFixed(2)+'<span class="unit">°C</span')}):$(".card__infobox").removeAttr("title").css("cursor","none").off("click"),c(t),-1!==window.location.href.indexOf("details.html")&&s()}),l()});